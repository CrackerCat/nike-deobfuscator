import base64
from Crypto.Util.Padding import unpad
from Crypto.Cipher import AES

def derive_key(enc_key: bytes) -> bytes:
    KEY = bytes.fromhex("29bb23dae3d6cd01677c6ca6139197cb801bc1b520433d71b39284d808ea3a6e")
    out = []
    m = 6 if enc_key[0] > 0x80 else 2
    for idx in range(0x20):
        out.append(enc_key[m])
        n = enc_key[m + 1] // 7
        m += enc_key[m + 1] + (n - (n << 3)) + 2

    return bytes(k ^ v for (k, v) in zip(out, KEY))

def decrypt(b64_payload: bytes) -> str:
    enc_payload = base64.b64decode(b64_payload)
    enc_key = enc_payload[:256]
    enc_msg = enc_payload[256:]
    cipher = AES.new(derive_key(enc_key), AES.MODE_ECB)
    return unpad(cipher.decrypt(enc_msg), AES.block_size).decode("utf8")

app_config = {
  "nrc-darksky-api-key": "dAlc0c05V6xr1IiKcSCYYb3rG/FpYWYVKitsxoEPkjDEZp1NWoOPF8Rar/h2EAuadkz96KcPkgZM4baS1qb0Eh7v77/NG3XwF0R8hY7JGfdvbuSjyXKDf5rKJ/1RXBNmUN8p98f8+audm6ByIQWgmnHf+HbwfLSg+Y7k4xlAtIj8ihvzfTgcFEAhFwvSCX3zIr8tg+KtOTABhBwbdZylD0TrbaK4xPLCVVpT/7pCH2TPM9VgLyR0skHrAt/O06z8xFK5Ns217LTmtHXIaQsiWO6nWWe8UOmF1hmUQCAbDZAoDPJ6/CiXjS4pKjM5PiSHz0Qhp6yNaalExxIh+n1P5vOZxKGbES3kCoUz69rFK7B0da1maGTEHvM2HuTaDIH1WnIoVdZ3WljvFs1W9jyqVw==",
  "nrc-events-x-api-authorization-header": "piWG9WjzsOAdjHitCYyD1dJYO6nGlBclMhAbG6SsbsaDpE1oNnhl+CuyrZDW1BrZpJkelXnaGrbrirO2kFi6AXVPHT5Eq3mOGOJ8p9tazxP1Km8+D0VzzPCRRtPOINnwCkoP/TfDA4SysAz8XRy0WuLe/+fnX9SmnUmUVsLho/GyjPcdymR52iq/tdCMx44MQnhH6YFbW0gBNMN898RnsSjSB5KUI8FrC8sPXGB7tBW/Rq5qjVWPiEwSBU9vWbTlHSAjkBM/fJQSkwdi2h6Q5t691phnmTH1Y7OPp49ZaEPSNpsb31jYCggxvwx9pdW01I23MbCI2oMs+aq9fxSORHz2tHHwe13IFEHwJp+g0gFGO0qlImAeLmwZZIJjd3KNT9VEdZhb1zvWkOWMc2KGhL402+LSC7dB4RopsJFYBfkysBUk6P3UVo9g5RLjSe0L",
  "nrc-events-x-api-client-id-header": "K8VA2aLaZk2+5hTiwyD8qdzB4pHQfxr1YsAP7bq5Gr2I4pCN6lWsL+zPs2aydCZ9hPmnbAqyam8Zetg1J8KjJNcaPpejB0Ffhq3v8kiAVEYRviEREn5b8/u7RjBzUdldSl4jt00CgXqkBbHosOl+tchmHm8CLfO1EvIO5B4RTziePqUqDEnFwngPcsMfXUdea4V54dmF+BdsoYZnBzv/vcRpkr8ubiEMz5J8VChiFmwMqgGW86jUvA3YCPCz4iH6JaRVCXYzbW2gbdfCZQXavay3LXaPCjUvZcd5nDabyVziph75CDEiooM4DAWZFbbA/iSWKzEpfQDeYQOrnPNGBpGhGClsEh5lpAYFxVTVbKWCkciAM3kVXMy6NWMEPD5FFD+YuGpMN9PqT0mI6NaeYA==",
  "nrc-facebook-shared-client-id": "ssxVMQUwJG1AiHuUW139AgDNFVzh0EWyitf0pcgFTwQtp4J5/Gb7seXCGbZClyQuW0+szHNx2v65n9OpFCm1Va7bVJ9GrzfY5+7O8Kwh+9B2TDNg0CSbjobPNFv1i8Cu+lDs0t0iCfcbujYU7gdqREr4Gf+tRhRyhhwjwvtGW4t9ke39fbAUsHHBnsy2nHiVd2oG7KVC7P+e3IDegZ0U63awO6Z213t1ROJTX7cUtSVsTK5U+JvhIpqRn9LAnQK0d8KIYDmCtGNtY+87b3IQIh2VXd/X2Y0plapTJpkbfC9igV+oPXIop/5rnWuvIu7psK877fyR5kk7CMQfp6GmgyqJR+4t9NdP4u6dAzx+kK0=",
  "nrc-facebook-shared-client-secret": "7xpEmpxOXF74SCrMA/yiZp/9xVnVsTkeFgaWcWU77FQ4K4jJ5ZYusve+W43fIsMctkGFdTlL/RDYQO3YECEZo4FquQZls+0KxpgFuh41nFOq64IFfjtgXwHW5c8d2bP3k/2ZoGf6GvjVP0Ilo67hIUIrPu8TPcWXjauCo49I0RXUvtIsnIvlOtgppEtlssRHRmj2oyQGnxzBLYFlhD/28Vnw21O90EyVeUcuXfJZ3/39agq+BBy0KW8+KSXkRIWz5MNmFvXASCmSd5GIEv1znyewK7xe8+RyJH43UHwG3TfMXZlz1vtWUAZah1oGpntRvAhVUKOhutzWkFGx7lvI3Jn2jlTUHsijiwIrE+CUHQcX7lVCDN6MdXUe+BzuGmY9ISmXeukJ/rGcj0jajHAHIw==",
  "nrc-feed-thread-auth": "sy8Epc331O+LrhIWTgu9gd/2NZ1jvOAH4HtNcBqiYbAKRkAUWIfrYi0XlBl+DlfQVf1vsQ/zgxhbGMKGOxxnwOFhTAKeNy2JUPKC82HQ5DfX9VkV2o5gdTwgjKXnElOba9fPmS+gpilDtKl9ZC1HaMUoy4Y9e9DBR5ZvG4yOaUCSnwag8Cb4gtft6rfH4D1nt5k/6oB5Jxw4c6JI1S2UIFjY2/vKOwkZe/hLnCZkzOejRb7nLPo3Ya7nWfhvbQoh4w9G0OcFTCk+8mx5384O2YxDh+g6zes5+6SGGoaaW/ljEq/wXFeOudmDUeod1J/KpDZSCT5XVDyY28kBAe1ALQD4uSak43M7RucYzPa+H+vPJYdeyXI61unNFCTMHG54JlyXU5XWCq8NRwUKAmdA2g==",
  "nrc-foursquare-client-id": "YEYAt7gsLqNOeJPlmIsbalQUwUzTA3/2yUkdT/TjQSZ8uQX5pAI4sg7NI8VBGmtW5NEIAwqmXOmHUgxi3OO4CIJPtj07sKEiJtP8KgyfOqUqz8U8FzvTxg1X8DnDXhx/pZm6l41Te4PyGKoqLWmmOfOpqynqiQM7jTUdXUWD+RypNrCbVLQPs0c7Y2YV0OQCl0MbqIbGen6Tt5gGoYbR+KCM4k3ecTgj6Y/iwfV6HEtC14MjZXk/OWyOhQq31BQ6pi1VsbPE+iz3iDikJ9VkBvMWDhSU892c59fIyiduzVkXojrCsXh6bPPxz7O0qjYJgoFBTalobw9eYPaMu9/kVGS0Ian4RCdWa28rZv8Rn2DIAPAZJ+qQQWp7cMlVtpQ96BqdHA+pAX+iJLeVZkuIGtk2pp0T3bIASgYJwMyx/gU=",
  "nrc-foursquare-client-secret": "o31VQa13lTpzND4ZXoyEk4mW+IoiDUP1bZVMBj3J305dGrsPzT7mFWoInFrDHEzixPjZDoliZoOB0PuZPmJO8sP2+1ZtsigVhNqST59E5O4wjYii5PMiRj7OYu1qQqkLof34HDNAoQo4xsxvV9lwUBYZ7c4LOOYXkwOxNVbgWZVT/KkttLuIeGjwTTx+BNkS5B9mUS28JydZf/0QtgGpgofW5JyF4Gis059Xy22gbP/nhDlL9Jft3B/qztA5v1Ur5QOWbJejMmeBqFV03y4Z3qDMER4ey4hLhngTywYhYhbGIUDr/L96pQdyYOFyI/Q/90W3EDhS0w7y+Hjjx3Ixz7+aD6nWIjIoTjpgyeaNLpMjXKpIAlLx+Z+x975WqR5PcXT1HU7jgnf99jUNU+I3drVUJ6SUHOof1sFGJRgtnps=",
  "nrc-gcm-sender": "rxUHbaxsy9X6j0aZwavPnfEktgigTmnajOEE2vmooFGWOEa7zsQMUUAjq6kkk+qAlVX2OuBYk2XFFaxU0Wnf4XGO5pk1JT2nD7KvYVbb87iEEk06KqosEfVRx6ALC8LNKJ83e1gU4BIuX3U7w6frF7yyBmiKLCHaMvpSYypwvqF5r+FHv2NOVz+JEZGW3R26AMLKxuGMIYzdP/i1SVNCCZ5rqpDI3MfU7ew4uRlbQV+aKSbCJ7WwaVPMkV5+e0ORP+AViHhtbOkD9IpD61jlG/uVeJ6PrrSRvAI6ZZIjPEkIUwKsuHPUPznn6+qnhH3w/FUNGbLflpkfzCe1jjfzsWTSyljkAxLmSw8NPdP/RP8=",
  "nrc-google-wallet-issuer-id": "uJ8slBqPwXVi0NMcAkpOt08TjqwPzpj0Hd2Xx12EBFT3H+R+BinyZJ2I9EsvJSfRN5nT+DposWtuhoCav4ipA3Z5jQ46yg5h2kQafqrTCiRbvw2xUYQ2K+JDBDo/SmkAlhNyfghqoJU/aks0Ig0WPLG5xollZzI1VxoRKKaqyvCEJfQty2y6jAiSQuBmsXyV7KDwjTfO7BhzWwgaI1j3E0NuKcqQpiRyJ89exZe5AZrJ2wiG5E16Ytiqab4Y4TSze34JwYt3YliAhr6fJkYwOel5EpQs9JCl5ExTwZ4LYXyiqc6dY0F0WVUKqWn7Jsjy1MJb2e5P/Ne/WQX9NJRxG8Hl3S3HB51NYI5aM4Aa/onEqnhXS2hc2RAlKe68UnxG",
  "nrc-imgur-client-id": "CyX530wNw6FtZB2g43tag05SxkDSxnt14CvANFVeznaFaHKyQhDLOBr7etTrrUfowo577rnoU2d5Usbq1DmeFow0BtoYArP2ehJewHtzV4uLlPeLnBKVgdg4PBzWH9tbwU3iJh7mESTl6/SHURVAS0VvNwIuJxpinUJQUyV4GMNWjNuTPeoeX9UxfngH0YuOWVl/53cApMZSA7EzOKJwS5Qq7bD7rr84/aEezTPMZnYOyURTkoi4MzaWXM0OABKmd6UxdCA3MsmCotX6B/gOR6vGVqMvokU79mdpC5tD6nuaxrluwUMt60ahNKAYFjyFvs4jF4F6Q4L7bKopUfreq56Gae84uNNS6Zp94hL4OzM=",
  "nrc-net-auth-token": "T9lsiC9sIArix6LQQvJXqdg6cKHMpu2irv551cV0w3b5s+sQMg/ALyloB7RKuumgIwKcj4Nwj5R2oKvTKaK1FYfGx+wxln0ll1jgOW1FeCnSdaIRekXOIx38tuene3IXodRZWbGJ1WeatMHYb6qFgehLmta3aabSv6bRmxCj1f2l3K+yKbCX3hjXV1ArpCIixGfwM7QBbmHKhcVGoPscJmyRRCtbidFqSNPyvzgPOBUi5tcXN7lRzFLs7LiP3bFH50poxNXNSFvcEVoKHanSZjs/JtBO6UGExORpjsyUhqzc8MAuvwzTdKz5w1LjIKEhS7ncIQEob45ZoJO12cEW3phou6shgNtIJ54wXuUB7WZd943mHQrmTKucifnfm+w+z5sP+UmCFBsbds6nXN9hqwDt68pAxFXSDXsP2L95HRhISoT44ikks5NkcXkcmbAY",
  "nrc-net-client-id": "HJi/kimMojNqygGyoImDT6IsgdJJ1OyLJW8TaLIOmK5JZeT5/r2nhELVybi2CqvfLuXjmgWu4ob903Dq5okXaIuA46jrjy+2FCfpOfNwfRfkUtiLdJFV+bLq+qHW5/JoLxPPBjbGMA8T2onbalOd55x+eDxJlHcyERtKkavccpj8bOmh8VSCyJdhr14FLfrpGEDkZWsqMw8d0MHAjsoG+tLxl4JnElM5/bmo38o+3kMmvUTqWqcvLy3Y90WQxw/AKWKW78Qsy6eye4zPHg/clICpjF8DF/A+gG4Jc8MIVKjqtrHdcQ4WAFT8OzrqTCZD9j6s3Of9olSF9MqW4mpjKCCXBU5gipk/tNVxdtkVErJUVKR/irwyzrKTF5K11Wnrcu0Rs+4/24rLrzRomGPqXw==",
  "nrc-omniture-app-visitor-id": "aww1QvMnJWtS1HUV2BAkQLBtN73V0F8AooeFg1Djr/SAPDDj2/chU+MS6qkUDGPR9BZINokpspDw9OV6vqS0YG4shRqiUh2PKzOdn8VQx/6DUR2ATz6OmCyjDM5wIxRpWvQ+q+9ONFIFj1w29K+Mek5l2kvjxaCXEilRsFv21jNXJsUrIU25kyJryDQvNtheHU9ORYH321Bo/2exTKr1gPiFBwopXexmiOGYM6j0PQcZCspGDFJ4AdNQ/QklUEMbDx5OD100M2OPVOxo+2fuGztj57NDbu7NAVx0GaQ8ygtTdmImt0dVKB95x3tRtlSQyLSpLVGdmulqn5auVy2FddTV1yZrum2Ic376Md0s4iMlSxrLEuCTM+MeJPPJKZ9q1uexK5Cgo5PVd3tFj4b7Ew==",
  "nrc-omniture-report-suite-id": "N8SUqTZmyiKCSlPSjjCTjC3QobHOO3GLm87hzGRKOU2QyP/jXcJ6EQ4cAbWBmhKX0Bdw2Y8hwqvA+Jjoo2z9fxj6KWkhl0e3kphhlxHvpxm+UonuMruMFRswXtxJuGdz6B81NXaOqnvt1FAY3YvxhGItYHgQAZ1kw/SaBGhRwFK+RG2hBIgpchcAynOTUrvtBWIlRfm6NNo3J0eItefiBiSVbqCRV72JasqQ0a+EkDPv1kq0cOq8LaJXejb8sv6U1WXHGKQ0/CwIG43jhIp5ZaGLo0M4C3BOPSkds+0ynEYrxIaNUg0NQy/U7T3rSkSTs3CMsh9HGvC2wohSM5PoivatGfp00N8uhWrHfosQdsk=",
  "nrc-segment-api-key": "4sk+vdohXtRY2UkXX2piy+oON0fs/0DjGNfyitJBXc+lIw57oSGIEJLreAPfzf/9KbdkLz2tKJM5wEbDy0LnrAba/lJNTv4semzO9HkudZD4sF/X8O/qwGQEBlQpyjntD11fOMGzIl83ZSC4w8RvDFCe2DQRMcVB/OCIKFwtcqUJyVLw1W9wJU4AQ733Uabd8KxWOeo/5Hi1B5/mdXlDJD6JnAZJDPhqclECRYW0bPHucvhNtrju/FT2kxlr/x5BhErDSuz2CbWCsLni3zM3Hx+XBvfNHhmINCxBpLdJhF976uHPUnlaVa0l7y6pV69ir/U8ikMD3Zqis0oBUyZA1wIESnJc+UsS63aNulB+agpMeIGtSVhKiZf8ctjv/lxD5dvWb4Dp54K5ZAfZ0Zxzrw==",
  "nrc-ua-client-id": "sYnkque+GFkvpThbZy6gVpk4oyi2nFB0jTLh0EyLIa4NZengxtzS5d4uKR+TevufP6CJX0Me3IcSUUsTBvhqTXJs7BAjs9NBRZiMSelgaJYYmLUmGZ46iBEf20ppYhKWaR9KShG1cJNvAT1AzWlzwKBS1Hf4n9Aw5YzqkpzLejyuKHdTdscVOqvnzDmWdFGkAtRNporAZ3bfD29dHR50wHHGpVp9aGfi7IkfWxL7hXnR2rEpWu7VB2AeBpzBv7mlNBkkeIpH/wZqLybPCriu4+S6ltCX8QB3b6ZjPVR4rf0HslI63ehSY3fdbL4Ry7Epoe8Ka72em18awEgZL2IzVSTw9DEVGl4tAKSnqh4873UYaxpY2ERSEGlboiXULmgy",
  "nrc-ua-client-secret": "4FHRf9Ng6HeMeMWH6rwUmPmn3nvlKF4ZpEa8FO6kl3g5Ltz+MAPAteu3CO86wWUvVFavquo/WST1DTpzyvSrx76vZJAD8AYIioLsGoyCUAe5J9J6VaZrnS9/QSKlXDDsxI1xs55/mduUs3AgqNMspTmHOanRNY5cFWL8GJs7HuTQ5lPyko56bNlz/WyR416atRrcofxAisGfpu1W4nzDwaDKNdzopdRejkyYB+ab0eS45b8IAnVaVu3B99pSqInC5/yIGWI5ZY0PfNy5IhtSzkyZ19K+fXtKup1vntEhXZ3/1TkUVwXXpimcab/TiCsz/Qxids7TEC02QnArT3nCsR2Plzf6PMDRGCeLxOVDkowCyo8G51zJzrKsD1g8M27x",
  "nrc-unite-client-id": "IFc97q8fSoR84EHfevnzBNivAiT6H+i8vmVZDnCAax/ZjSGxw5ejdekfXtCrzrtJrQfJnj30JeK+MsyruZi8sW6iUBfe//NGZlpQJXUbz8LuPEXnLMAlxKdLV6BrBgKHqNI94nfSHCCr0xW3HOZk/XyFdevndG52zmZR0XXym0yW5d8n/XvLGDCtVyryFLYoYwHYrDC9JZ+GfAacPKE5S437fT9Af+Z/AeZgqPplm9mCaPBoOc0Co4+h3nT8TvXMsU4Vy8pRTuWv0skMU0uwUkq7R/UN06daQ8AkAaYt7KWG0S36tSbHuR03ji7om8ebOJqOzgFyYOp/KfkHkvX5+PVk2lG7lk1hBltitrBND8njmHHIPisC6+W7Ul1an0mRiNTQVFfSJpyNUVvE1D17NQ==",
}
for k, v in app_config.items():
    print("{:<40}: {}".format(k, decrypt(v)))
